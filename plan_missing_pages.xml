<?xml version="1.0" encoding="UTF-8"?>
<prompt>
  <metadata>
    <title>Implement Missing Dashboard Pages</title>
    <phase>Execution</phase>
    <difficulty>medium</difficulty>
    <estimated_time>45-60 minutes</estimated_time>
    <version>1.0</version>
    <last_updated>2025-11-19</last_updated>
    <prerequisites>
      <prerequisite>Dashboard Sidebar implemented</prerequisite>
      <prerequisite>Database schema defined (users, vehicles, workshops, services, requests)</prerequisite>
    </prerequisites>
  </metadata>

  <thinking_configuration>
    <claude_extended_thinking>
      <enabled>true</enabled>
      <reasoning>
        This task requires implementing multiple pages with data fetching and UI components.
        We need to ensure consistent styling and correct data access patterns using the existing DB schema.
        Handling empty states and user roles correctly is important.
      </reasoning>
      <budget_tokens>10000</budget_tokens>
      <expected_thinking_depth>
        Analyze the DB schema to determine the best way to fetch data for each page.
        Design the UI for each page to match the existing dashboard aesthetic.
        Plan for error handling and empty states.
      </expected_thinking_depth>
    </claude_extended_thinking>
  </thinking_configuration>

  <context>
    <project_info>
      <name>Hugo Automotriz</name>
      <current_location>/Users/agustinmontoya/Projectos/hugo-automotriz</current_location>
      <framework>Next.js 16.0.3</framework>
      <status>Development</status>
    </project_info>

    <objective>
      <primary>
        Implement the missing dashboard pages referenced in the sidebar navigation to provide a complete user experience for both Drivers and Workshop Owners.
      </primary>
      <success_criteria>
        <criterion>✅ Driver History page displays past requests and appointments.</criterion>
        <criterion>✅ Driver Settings page allows viewing profile and vehicles.</criterion>
        <criterion>✅ Workshop Services page lists services and allows management (UI).</criterion>
        <criterion>✅ Workshop Settings page allows updating workshop details.</criterion>
        <criterion>✅ All sidebar links work without 404 errors.</criterion>
      </success_criteria>
    </objective>
  </context>

  <instructions>
    <step number="1">
      <title>Implement Driver History Page</title>
      <thinking_guidance>
        Analyze `src/db/schema.ts` to understand `assistanceRequests` and `appointments`.
        We need to fetch these for the current user.
        Display them in two sections or tabs.
        Handle the case where there are no records.
      </thinking_guidance>
      <action>
        Create `src/app/dashboard/driver/history/page.tsx`.
        Fetch `assistanceRequests` and `appointments` using `db.query`.
        Render lists using `Card` components.
      </action>
    </step>

    <step number="2">
      <title>Implement Driver Settings Page</title>
      <thinking_guidance>
        We need to show user details (from `users` table) and their vehicles (from `vehicles` table).
        The page should have a section for Profile and a section for Vehicles.
        Include a "Add Vehicle" button (UI only for now).
      </thinking_guidance>
      <action>
        Create `src/app/dashboard/driver/settings/page.tsx`.
        Fetch user with `vehicles` relation.
        Render profile form and vehicle list.
      </action>
    </step>

    <step number="3">
      <title>Implement Workshop Services Page</title>
      <thinking_guidance>
        This page is for Workshop Owners.
        We need to find the workshop owned by the current user.
        Then fetch its services.
        Display as a grid of cards.
      </thinking_guidance>
      <action>
        Create `src/app/dashboard/workshop/services/page.tsx`.
        Fetch workshop by `ownerId` with `services` relation.
        Render service cards with price and duration.
      </action>
    </step>

    <step number="4">
      <title>Implement Workshop Settings Page</title>
      <thinking_guidance>
        Allow workshop owners to edit their workshop details (name, address, description).
        Pre-fill the form with existing data.
        Show current coordinates (read-only or with map picker).
      </thinking_guidance>
      <action>
        Create `src/app/dashboard/workshop/settings/page.tsx`.
        Fetch workshop details.
        Render a form with `Input` and `Textarea` components.
      </action>
    </step>
  </instructions>

  <validation>
    <execution_checklist>
      <item>✅ `/dashboard/driver/history` loads and shows data.</item>
      <item>✅ `/dashboard/driver/settings` shows profile and vehicles.</item>
      <item>✅ `/dashboard/workshop/services` shows services list.</item>
      <item>✅ `/dashboard/workshop/settings` shows workshop form.</item>
    </execution_checklist>
  </validation>

  <output_format>
    <structure>
      <section name="execution_log">Detailed log of created files.</section>
      <section name="results">Verification results.</section>
    </structure>
    <format>Markdown</format>
  </output_format>
</prompt>
